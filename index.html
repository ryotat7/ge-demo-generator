<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ADK Agent Demo Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            }
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
    }

    .glass {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .gradient-bg {
      background: radial-gradient(circle at top right, #0c4a6e, #0f172a);
    }

    .spinner {
      animation: rotate 2s linear infinite;
    }

    @keyframes rotate {
      100% {
        transform: rotate(360deg);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .idea-chip {
      transition: all 0.2s;
    }

    .idea-chip:hover {
      background: rgba(14, 165, 233, 0.2);
      border-color: #0ea5e9;
      color: white;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #475569;
    }

    .highlight-glow {
      box-shadow: 0 0 15px rgba(14, 165, 233, 0.3);
    }

    .step-completed {
      border-color: #10b981;
      background: rgba(16, 185, 129, 0.05);
    }

    .step-completed .step-icon {
      background: #10b981;
      color: white;
      animation: none;
    }

    #archChevron.rotated {
      transform: rotate(180deg);
    }

    #toast {
      visibility: hidden;
      min-width: 250px;
      margin-left: -125px;
      background-color: #0ea5e9;
      color: #fff;
      text-align: center;
      border-radius: 12px;
      padding: 16px;
      position: fixed;
      z-index: 100;
      left: 50%;
      bottom: 30px;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      opacity: 0;
      transition: opacity 0.3s, bottom 0.3s, visibility 0.3s;
    }

    #toast.show {
      visibility: visible;
      opacity: 1;
      bottom: 50px;
    }

    /* Navigation Sidebar */
    .nav-container {
      position: sticky;
      top: 2rem;
      height: fit-content;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      color: #94a3b8;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      transition: all 0.2s;
      border: 1px solid transparent;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #f1f5f9;
    }

    .nav-item.active {
      background: rgba(14, 165, 233, 0.1);
      border-color: rgba(14, 165, 233, 0.3);
      color: #38bdf8;
      box-shadow: 0 4px 12px rgba(14, 165, 233, 0.1);
    }

    .nav-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
    }

    html {
      scroll-behavior: smooth;
    }

    section {
      scroll-margin-top: 2rem;
    }
  </style>
</head>

<body class="gradient-bg min-h-screen text-gray-100 font-inter">
  <div class="flex h-screen overflow-hidden">
    <!-- History Sidebar -->
    <aside id="sidebar" class="w-72 glass border-r border-gray-700 p-4 hidden lg:block overflow-y-auto">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xs font-semibold uppercase tracking-wider text-gray-400">Recent Demos</h2>
        <button onclick="clearHistory()"
          class="text-[10px] text-gray-500 hover:text-red-400 transition-colors uppercase font-bold">Clear</button>
      </div>
      <div id="historyList" class="space-y-3">
        <!-- History items will be injected here -->
      </div>
    </aside>

    <!-- Interactive Navigation Sidebar -->
    <aside class="w-64 p-6 hidden xl:block">
      <div class="nav-container space-y-2">
        <div class="px-3 mb-4">
          <h3 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Navigation</h3>
        </div>
        <a href="#section-step1" class="nav-item active" data-section="section-step1">
          <div class="nav-dot"></div>
          Step 1: Define Goal
        </a>
        <a href="#section-step2" class="nav-item" data-section="section-step2">
          <div class="nav-dot"></div>
          Step 2: Customize
        </a>
        <a href="#section-step3" class="nav-item" data-section="section-step3">
          <div class="nav-dot"></div>
          Step 3: Deploy
        </a>
        <a href="#section-step4" class="nav-item" data-section="section-step4">
          <div class="nav-dot"></div>
          Step 4: Run Demo
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-6 lg:p-10">
      <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="mb-10 text-center lg:text-left relative">
          <div class="absolute -top-4 -right-4 hidden lg:block text-right">
            <div
              class="text-[11px] text-gray-400 font-medium tracking-tight bg-white/5 px-3 py-1.5 rounded-full border border-white/10 shadow-sm">
              Author: <a href="https://moma.corp.google.com/person/ryotat" target="_blank"
                class="text-sky-400 hover:text-sky-300 transition-colors font-bold ml-1">ryotat@google.com</a>
            </div>
          </div>
          <div
            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-sky-500/10 border border-sky-500/20 text-sky-400 text-xs font-medium mb-4">
            <span class="relative flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-sky-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-sky-500"></span>
            </span>
            Gemini Enterprise Demo Generator
          </div>
          <h1
            class="text-4xl lg:text-5xl font-bold tracking-tight mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400">
            Build and run your custom agent demo
          </h1>
          <p
            class="text-gray-400 text-lg max-w-2xl text-center lg:text-left mx-auto lg:mx-0 leading-relaxed font-light">
            Instantly generate <b>custom demo environments</b> for any business domain. This tool <b>dynamically
              synthesizes datasets</b> and configures agents tailored to your client's unique challenges.
            It is based on the <a href="https://github.com/google/mcp/tree/main/examples/launchmybakery" target="_blank"
              class="text-sky-400 hover:underline font-medium">LaunchMyBakery</a> repository. For a deep dive into the
            architecture, see this <a href="https://adventofagents.com/day/11" target="_blank"
              class="text-sky-400 hover:underline font-medium">architectural overview video</a>.
          </p>
        </header>

        <!-- Demo Overview & Architecture (Collapsible) -->
        <section class="glass rounded-3xl mb-10 overflow-hidden border border-white/5 shadow-xl">
          <button onclick="toggleArchitecture()"
            class="w-full flex items-center justify-between p-6 lg:p-8 hover:bg-white/5 transition-all text-left group">
            <div class="flex items-center gap-4">
              <div
                class="w-10 h-10 rounded-2xl bg-sky-500/10 flex items-center justify-center text-sky-400 group-hover:scale-110 transition-transform">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                  </path>
                </svg>
              </div>
              <div>
                <h3 class="text-sm font-bold text-gray-200">How it works: Dynamic Demo Synthesis</h3>
                <p class="text-[11px] text-gray-500 mt-1">Architecture and data orchestration details</p>
              </div>
            </div>
            <svg id="archChevron" class="w-5 h-5 text-gray-600 transition-transform duration-300" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <div id="architectureContent" class="hidden border-t border-white/5 bg-black/20 p-6 lg:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
              <div>
                <h3 class="text-xs font-bold text-sky-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z">
                    </path>
                  </svg>
                  Dynamic Data Generation
                </h3>
                <p class="text-[13px] text-gray-300 leading-relaxed mb-4">
                  Unlike static templates, this accelerator <b>auto-generates data</b> based on the customer problem you
                  input. It creates an orchestration between <b>BigQuery</b> macro-analytics and <b>Google Maps</b>
                  real-world grounding.
                </p>
                <ul class="space-y-3">
                  <li class="text-[11px] text-gray-300 flex items-start gap-2">
                    <span class="text-sky-400 mt-0.5">‚Ä¢</span>
                    <span><b>Contextual Data:</b> Dynamically generated demographics, sales history, and market
                      trends.</span>
                  </li>
                  <li class="text-[11px] text-gray-300 flex items-start gap-2">
                    <span class="text-sky-400 mt-0.5">‚Ä¢</span>
                    <span><b>Tailored Reasoning:</b> A pre-configured agent with instructions specific to the business
                      goal.</span>
                  </li>
                </ul>
              </div>

              <div class="relative">
                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4">Agent Runtime Architecture
                </h3>
                <div
                  class="relative flex items-center justify-center min-h-[160px] bg-sky-900/10 rounded-2xl border border-sky-500/10">
                  <svg class="w-full h-full" viewBox="0 0 400 180" fill="none">
                    <path d="M120 90 L200 45 M120 90 L200 90 M120 90 L200 135" stroke="#334155" stroke-width="1.2"
                      stroke-dasharray="3 3" />
                    <path d="M300 90 L340 90 M300 135 L340 135" stroke="#334155" stroke-width="1.2" />
                    <rect x="20" y="70" width="100" height="40" rx="6" fill="white" stroke="#E2E8F0" stroke-width="1" />
                    <text x="70" y="88" text-anchor="middle" fill="#475569" font-family="Inter" font-size="8"
                      font-weight="600">ADK Agent</text>
                    <rect x="200" y="25" width="100" height="40" rx="6" fill="white" stroke="#E2E8F0"
                      stroke-width="1" />
                    <text x="250" y="43" text-anchor="middle" fill="#475569" font-family="Inter" font-size="8"
                      font-weight="600">Gemini 3 Pro</text>
                    <rect x="200" y="70" width="100" height="40" rx="6" fill="white" stroke="#E2E8F0"
                      stroke-width="1" />
                    <text x="250" y="88" text-anchor="middle" fill="#475569" font-family="Inter" font-size="8"
                      font-weight="600">MCP BigQuery</text>
                    <rect x="200" y="115" width="100" height="40" rx="6" fill="white" stroke="#E2E8F0"
                      stroke-width="1" />
                    <text x="250" y="133" text-anchor="middle" fill="#475569" font-family="Inter" font-size="8"
                      font-weight="600">MCP Maps</text>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Generation Form - Step 1 -->
        <section id="section-step1" class="glass rounded-3xl p-6 lg:p-8 mb-10 fade-in shadow-xl ring-2 ring-sky-500/20">
          <div class="flex items-center gap-3 mb-8">
            <span
              class="flex h-10 w-10 items-center justify-center rounded-2xl bg-sky-500 text-white font-bold shadow-lg shadow-sky-500/40">1</span>
            <div>
              <h2 class="text-xl font-bold text-white uppercase tracking-tight">Step 1: Define Business Challenge</h2>
              <p class="text-[11px] text-gray-500">Select a template or describe your customer's problem</p>
            </div>
          </div>

          <!-- Templates & Language -->
          <div class="mb-8 p-6 bg-white/5 rounded-2xl border border-white/10 shadow-inner">
            <div class="flex items-center justify-between mb-4">
              <label class="text-[10px] font-bold text-sky-400 uppercase tracking-widest flex items-center gap-2">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                Industry Templates
              </label>
              <div class="flex items-center gap-2 bg-black/20 rounded-lg p-1 border border-white/5 shadow-sm">
                <svg class="w-3 h-3 text-gray-500 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129">
                  </path>
                </svg>
                <select id="langSelector" onchange="updateSamples()"
                  class="bg-transparent text-[10px] outline-none text-sky-400 font-bold px-1 py-0.5 cursor-pointer hover:text-sky-300 transition-colors">
                  <option value="en">English</option>
                  <option value="ja">Êó•Êú¨Ë™û</option>
                  <option value="zh">‰∏≠Êñá</option>
                  <option value="fr">Fran√ßais</option>
                  <option value="de">Deutsch</option>
                  <option value="es">Espa√±ol</option>
                </select>
              </div>
            </div>

            <div id="sampleChips" class="flex flex-wrap gap-2.5">
              <!-- Samples will be injected here -->
            </div>
          </div>

          <div class="mb-6">
            <label class="block text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-3 ml-1">Detail the
              Business Scenario</label>
            <textarea id="userGoal" rows="4"
              class="w-full bg-gray-900/50 border border-gray-700 rounded-2xl p-4 text-gray-100 placeholder-gray-600 focus:ring-2 focus:ring-sky-500 focus:border-transparent transition-all shadow-inner leading-relaxed"
              placeholder="Example: How to help a retail chain in London optimize seasonal stock based on demographic shifts and regional foot traffic trends?"></textarea>
          </div>

          <!-- Options -->
          <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 border-t border-gray-700 pt-8">
            <div>
              <label class="block text-[10px] text-gray-500 mb-2 font-bold uppercase tracking-widest">Synthesis
                Volume</label>
              <select id="rowCount"
                class="w-full bg-gray-800/50 border border-gray-600 rounded-xl p-3 text-xs text-gray-200">
                <option value="50">50 Rows per Table</option>
                <option value="100" selected>100 Rows per Table</option>
                <option value="500">500 Rows per Table</option>
              </select>
            </div>
            <div>
              <label class="block text-[10px] text-gray-500 mb-2 font-bold uppercase tracking-widest">Dataset
                Complexity</label>
              <select id="tableCount"
                class="w-full bg-gray-800/50 border border-gray-600 rounded-xl p-3 text-xs text-gray-200">
                <option value="1">Minimal (1 Table)</option>
                <option value="2">Standard (2 Tables)</option>
                <option value="3" selected>Advanced (3 Tables)</option>
              </select>
            </div>
            <div>
              <label class="block text-[10px] text-gray-500 mb-2 font-bold uppercase tracking-widest">External Data
                Link</label>
              <input id="publicDatasetId" type="text"
                class="w-full bg-gray-800/50 border border-gray-600 rounded-xl p-3 text-xs text-gray-200 placeholder-gray-600"
                placeholder="Optional: bigquery-public-data.xxx">
            </div>
          </div>

          <!-- Generate Button -->
          <button id="generateBtn" onclick="generateDemo()"
            class="mt-10 w-full bg-gradient-to-r from-sky-600 to-blue-700 hover:from-sky-500 hover:to-blue-600 text-white font-bold py-5 px-6 rounded-2xl transition-all shadow-lg hover:shadow-sky-500/30 active:scale-[0.99] disabled:opacity-50 flex items-center justify-center gap-3 group">
            <span id="btnText" class="text-lg uppercase tracking-widest">Synthesize Custom Demo Assets</span>
            <svg id="btnSpinner" class="hidden w-6 h-6 spinner" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
              </path>
            </svg>
            <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
            </svg>
          </button>
        </section>

        <!-- Progress Indicator -->
        <section id="stepsSection" class="hidden glass rounded-2xl p-6 mb-10 fade-in border border-sky-500/30">
          <div class="space-y-4">
            <div id="progress-step-1" class="flex items-center gap-4 transition-all duration-300">
              <div class="step-icon w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-[10px] font-bold">
                1</div>
              <div class="flex-1">
                <p class="text-[11px] font-bold text-gray-300 uppercase tracking-tighter">Domain Logic & Data Synthesis
                </p>
                <p class="text-[9px] text-gray-500 step-message italic">Synthesizing...</p>
              </div>
            </div>
            <div id="progress-step-2" class="flex items-center gap-4 transition-all duration-300">
              <div class="step-icon w-6 h-6 rounded bg-gray-700 flex items-center justify-center text-[10px] font-bold">
                2</div>
              <div class="flex-1">
                <p class="text-[11px] font-bold text-gray-300 uppercase tracking-tighter">Deployable Bundle Packaging
                </p>
                <p class="text-[9px] text-gray-500 step-message italic">Waiting...</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Error Section -->
        <section id="errorSection"
          class="hidden glass rounded-2xl p-6 mb-10 border-l-4 border-red-500 fade-in text-red-100 text-xs font-mono">
          <p id="errorMessage"></p>
        </section>

        <!-- Result Section -->
        <section id="resultSection" class="hidden space-y-10 fade-in pb-24">

          <!-- Step 2: Review & Customize Assets -->
          <div id="section-step2" class="glass rounded-3xl p-8 border border-white/5 scroll-mt-8">
            <div class="flex items-center gap-3 mb-8">
              <span
                class="flex h-10 w-10 items-center justify-center rounded-2xl bg-sky-500 text-white font-bold shadow-lg shadow-sky-500/40">2</span>
              <h2 class="text-xl font-bold text-white uppercase tracking-tight">Step 2: Review & Customize Assets</h2>
            </div>

            <!-- System Instruction -->
            <div class="mb-10">
              <label
                class="block text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-3 flex items-center gap-2">
                Refine Agent Persona & Instructions
                <span
                  class="text-[8px] font-normal lowercase opacity-60 bg-white/5 px-2 py-0.5 rounded-full border border-white/10">Dynamic
                  script update</span>
              </label>
              <textarea id="systemInstruction" oninput="updateScriptLocally()" rows="3"
                class="w-full bg-black/40 border border-gray-700 rounded-2xl p-5 text-[11px] text-sky-200 font-mono transition-all focus:ring-1 focus:ring-sky-500 shadow-inner leading-relaxed"></textarea>
            </div>

            <!-- Data Preview -->
            <div>
              <div class="flex items-center justify-between mb-4">
                <label class="block text-[10px] font-bold text-gray-500 uppercase tracking-widest">Audit Synthesized
                  Data Library</label>
                <button onclick="downloadAllCSV()"
                  class="text-[9px] text-sky-400 font-bold border-b border-sky-400/30 hover:text-sky-300 transition-colors uppercase font-mono">Download
                  Raw CSVs</button>
              </div>
              <div id="dataPreview" class="space-y-4"></div>
            </div>
          </div>

          <!-- Step 3: Deploy -->
          <div id="section-step3"
            class="glass rounded-3xl p-10 border border-emerald-500/40 shadow-2xl shadow-emerald-900/20 bg-gradient-to-br from-emerald-900/10 to-transparent scroll-mt-8">
            <div class="flex items-center gap-4 mb-10">
              <span
                class="flex h-12 w-12 items-center justify-center rounded-2xl bg-emerald-500 text-white font-bold text-xl shadow-lg shadow-emerald-500/40">3</span>
              <div>
                <h2 class="text-2xl font-bold text-white uppercase tracking-tight">Step 3: Deploy</h2>
                <p class="text-[11px] text-gray-500">Run the synthesized environment in your own GCP project</p>
              </div>
            </div>

            <!-- Step 1: Initialization (Keep as sub-step title for clarity within Step 3) -->
            <div class="mb-0">
              <div class="flex items-center justify-between mb-4">
                <label
                  class="block text-[11px] font-bold text-sky-400 uppercase tracking-widest flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                  </svg>
                  Execute in Google Cloud Shell
                </label>
                <a href="https://shell.cloud.google.com/cloudshell/editor?cloudshell_tutorial=tutorial.md&cloudshell_git_repo=https://github.com/ryotat7/ge-demo-generator.git"
                  target="_blank" rel="noopener noreferrer"
                  class="px-4 py-1.5 bg-sky-500 hover:bg-sky-400 text-white font-bold rounded-lg text-[10px] transition-all shadow-md flex items-center gap-2">
                  LAUNCH TUTORIAL
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                </a>
              </div>

              <div class="relative group mb-6">
                <div
                  class="absolute -top-3 left-6 px-3 py-1 bg-gray-800 text-[9px] font-mono text-gray-500 rounded border border-gray-700">
                  Setup Script</div>
                <pre id="setupCommand"
                  class="bg-black/80 rounded-2xl p-8 pt-10 text-[12px] font-mono text-emerald-400 overflow-x-auto border border-sky-500/20 group-hover:border-sky-500/50 transition-all shadow-2xl leading-relaxed"></pre>
                <div class="absolute top-4 right-4 flex gap-2">
                  <button onclick="downloadScript()" title="Download as .sh file"
                    class="p-2.5 rounded-xl bg-gray-800/80 text-gray-400 hover:text-sky-400 border border-gray-700 transition-all shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                  </button>
                  <button onclick="copy('setupCommand')" title="Copy to clipboard"
                    class="p-2.5 rounded-xl bg-gray-800/80 text-gray-400 hover:text-white border border-gray-700 transition-all shadow-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3">
                      </path>
                    </svg>
                  </button>
                </div>
              </div>
              <p class="text-[10px] text-gray-500 flex items-center gap-2 px-2">
                <svg class="w-3 h-3 text-sky-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                This command will install the ADK, configure BigQuery and Maps MCP servers, and push generated datasets.
              </p>
            </div>

            <!-- Step 2: Interactive Guide -->
            <div id="section-step4" class="mt-12 pt-12 border-t border-white/10 scroll-mt-12">
              <div class="flex items-center gap-4 mb-10">
                <span
                  class="flex h-12 w-12 items-center justify-center rounded-2xl bg-emerald-500 text-white font-bold text-xl shadow-lg shadow-emerald-500/40">4</span>
                <div>
                  <h2 class="text-2xl font-bold text-white uppercase tracking-tight">Step 4: Run Live Demo</h2>
                  <p class="text-[11px] text-gray-500">Engage with your agent using personalized scenarios</p>
                </div>
              </div>

              <div class="flex items-center justify-between mb-6">
                <label
                  class="block text-[11px] font-bold text-emerald-400 uppercase tracking-widest flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z">
                    </path>
                  </svg>
                  Recommended Demo Flow (Tailored Prompts)
                </label>
              </div>
              <div id="demoGuideSteps" class="grid grid-cols-1 gap-4">
                <!-- Prompts will be injected here -->
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <div id="toast">Copied to clipboard!</div>

  <script>
    let currentData = null;

    function toggleArchitecture() {
      const content = document.getElementById('architectureContent');
      const chevron = document.getElementById('archChevron');
      content.classList.toggle('hidden');
      chevron.classList.toggle('rotated');
    }

    const SAMPLES = {
      en: [
        { label: "üìâ SaaS Churn", text: "Global SaaS churn analysis and customer retention strategy using historical usage patterns." },
        { label: "üèôÔ∏è NY Retail", text: "Retail optimization for Manhattan stores by correlating foot traffic, sales, and local weather." },
        { label: "üì¶ Supply Chain", text: "Factory downtime prediction and inventory optimization based on parts failure history." },
        { label: "üè• Health Tech", text: "Predicting patient readmission rates and optimizing hospital staffing based on historical health data." },
        { label: "‚ö° Smart Grid", text: "Optimizing energy distribution and predicting peak load demands for a city-scale smart grid." }
      ],
      ja: [
        { label: "üè™ Â∞èÂ£≤Â∫óÂ£≤‰∏ä", text: "Êù±‰∫¨ÈÉΩÂÜÖ„ÅÆÂ∞èÂ£≤Â∫óÂ£≤‰∏äÂàÜÊûê„Å®„ÄÅÊ∞óË±°„Éá„Éº„Çø„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„ÅüÂú®Â∫´ÊúÄÈÅ©Âåñ„Åä„Çà„Å≥ÈúÄË¶Å‰∫àÊ∏¨„Éá„É¢„ÄÇ" },
        { label: "üè® „Éõ„ÉÜ„É´ÈúÄË¶Å", text: "Ë¶≥ÂÖâÈÉΩÂ∏Ç„Å´„Åä„Åë„Çã„Éõ„ÉÜ„É´„ÅÆÁ®ºÂÉçÁéá‰∫àÊ∏¨„Å®„ÄÅÂë®Ëæ∫„Ç§„Éô„É≥„Éà„Éá„Éº„Çø„ÇíÊ¥ªÁî®„Åó„Åü‰æ°Ê†ºÂãïÂêëÂàÜÊûê„ÄÇ" },
        { label: "üöö Áâ©ÊµÅÂäπÁéáÂåñ", text: "ÈÖçÈÄÅ„É´„Éº„Éà„ÅÆÈÅÖÂª∂‰∫àÊ∏¨„Å®„ÄÅ„Éà„É©„Éï„Ç£„ÉÉ„ÇØ„Éë„Çø„Éº„É≥„Å´Âü∫„Å•„ÅÑ„ÅüÁáÉÊñôÂäπÁéá„ÅÆÊúÄÈÅ©Âåñ„Éá„É¢„ÄÇ" },
        { label: "üöú Ëæ≤Ê•≠DX", text: "ÂèéÁ©´Èáè„ÅÆ‰∫àÊ∏¨„Å®„ÄÅÊ∞óÂÄô„Éá„Éº„Çø„Åä„Çà„Å≥Â∏ÇÂ†¥‰æ°Ê†º„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„ÅüÂñ∂Ëæ≤Ë®àÁîª„ÅÆÊúÄÈÅ©Âåñ„Éá„É¢„ÄÇ" },
        { label: "üè≠ Ë£ΩÈÄ†„É©„Ç§„É≥", text: "Ë£ΩÈÄ†Â∑•Á®ã„ÅÆ„Éú„Éà„É´„Éç„ÉÉ„ÇØÊ§úÁü•„Å®„ÄÅ„Çª„É≥„Çµ„Éº„Éá„Éº„Çø„Å´Âü∫„Å•„ÅÑ„Åü‰øùÂÆà„Çø„Ç§„Éü„É≥„Ç∞„ÅÆ‰∫àÊ∏¨ÊúÄÈÅ©Âåñ„ÄÇ" }
      ],
      zh: [
        { label: "üõí Èõ∂ÂîÆÂàÜÊûê", text: "Èõ∂ÂîÆÈîÄÂîÆÂàÜÊûêÂíåÁªìÂêàÂ§©Ê∞îÊï∞ÊçÆÁöÑÂ∫ìÂ≠ò‰ºòÂåñ" },
        { label: "üìâ ÂÆ¢Êà∑ÊµÅÂ§±", text: "ÂÖ®ÁêÉÂåñ‰∫ßÂìÅÁöÑSaaSËÆ¢ÈòÖÊµÅÂ§±ÂàÜÊûêÂíåÊî∂ÂÖ•‰∫àÊ∏¨" },
        { label: "üèóÔ∏è ‰æõÂ∫îÈìæ", text: "ÂÖ®ÁêÉÂà∂ÈÄ†‰ºÅ‰∏öÁöÑ‰æõÂ∫îÈìæ‰ºòÂåñÂíåÂ∫ìÂ≠òÁÆ°ÁêÜ" },
        { label: "üè¶ ÈáëËûçÈ£éÈô©", text: "Âü∫‰∫é‰∫§ÊòìÂéÜÂè≤Âíå‰ø°Áî®ËØÑÂàÜÁöÑÈáëËûçÊ¨∫ËØàÊ£ÄÊµãÂíåÈ£éÈô©ËØÑ‰º∞„Éá„É¢„ÄÇ" },
        { label: "üöó Êô∫ÊÖß‰∫§ÈÄö", text: "ÂüéÂ∏Ç‰∫§ÈÄöÊµÅÈáèÈ¢ÑÊµãÂíåÂü∫‰∫éÂÆûÊó∂Êï∞ÊçÆÁöÑË∑ØÁΩë‰ºòÂåñÊñπÊ°à„ÄÇ" }
      ],
      fr: [
        { label: "üìä Ventes D√©tail", text: "Analyse des ventes au d√©tail et optimisation des stocks combin√©e aux donn√©es m√©t√©orologiques" },
        { label: "üöõ Cha√Æne Logistique", text: "Optimisation de la cha√Æne logistique et gestion des stocks pour un fabricant mondial" },
        { label: "üíé Luxe & Trends", text: "Analyse des sentiments sur les r√©seaux sociaux et d√©couverte de trends pour une marque de luxe" },
        { label: "üè• Sant√© Connect√©e", text: "Pr√©diction des taux de r√©admission des patients et optimisation du personnel hospitalier." },
        { label: "üîå √ânergie Verte", text: "Optimisation de la distribution d'√©nergie et pr√©diction de la demande pour un r√©seau intelligent." }
      ],
      de: [
        { label: "üìà Einzelhandel", text: "Einzelhandelsumsatzanalyse und Bestandsoptimierung kombiniert mit Wetterdaten" },
        { label: "üè≠ Produktion", text: "Vorausschauende Wartung und Ausfallzeitprognose basierend auf Produktionsdaten" },
        { label: "üè¶ Fintech Risiko", text: "Finanzielle Risikobewertung und Optimierung von Anlageportfolios" },
        { label: "üè• Medizintechnik", text: "Vorhersage von Patienten-Wiederaufnahmeraten und Optimierung der Personalbesetzung in Krankenh√§usern." },
        { label: "üåê Smart City", text: "Optimierung des Verkehrsflusses und Vorhersage der Luftqualit√§t basierend auf Sensordaten." }
      ],
      es: [
        { label: "üè™ Venta Minorista", text: "An√°lisis de ventas minoristas y optimizaci√≥n de inventario combinados con datos meteorol√≥gicos" },
        { label: "üì¶ Cadena de Suministro", text: "Optimizaci√≥n de la cadena de suministro y gestion de inventario para un fabricante global" },
        { label: "üç∑ Exportaci√≥n", text: "An√°lisis de mercados internacionales y predicci√≥n de demanda para exportaci√≥n agr√≠cola" },
        { label: "üöú AgroTech", text: "Predicci√≥n del rendimiento de cultivos y optimizaci√≥n de la planificaci√≥n agr√≠cola basada en el clima." },
        { label: "üè• Salud Digital", text: "Predicci√≥n de reingresos de pacientes y optimizaci√≥n del personal sanitario en hospitales." }
      ]
    };

    function updateSamples() {
      const lang = document.getElementById('langSelector').value;
      const container = document.getElementById('sampleChips');
      if (!container) return;
      container.innerHTML = '';
      if (SAMPLES[lang]) {
        SAMPLES[lang].forEach((sample, i) => {
          const btn = document.createElement('button');
          btn.onclick = () => setIdea(sample.text);
          btn.className = "idea-chip px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-gray-300 hover:text-white hover:bg-sky-500/20 hover:border-sky-500/50 transition-all text-[11px] font-medium shadow-sm hover:shadow-sky-500/20";
          btn.innerText = sample.label;
          container.appendChild(btn);
        });
      }
    }

    function setIdea(text) {
      const el = document.getElementById('userGoal');
      el.value = text;
      el.classList.add('highlight-glow');
      setTimeout(() => el.classList.remove('highlight-glow'), 1000);
    }

    function generateDemo() {
      const userGoal = document.getElementById('userGoal').value;
      if (!userGoal) return alert('Goal required.');
      const options = { rowCount: document.getElementById('rowCount').value, tableCount: document.getElementById('tableCount').value, publicDatasetId: document.getElementById('publicDatasetId').value };

      const stepsSection = document.getElementById('stepsSection');
      stepsSection.classList.remove('hidden');
      document.getElementById('resultSection').classList.add('hidden');
      document.getElementById('errorSection').classList.add('hidden');

      // Reset progress UI
      const s1 = document.getElementById('progress-step-1');
      const s2 = document.getElementById('progress-step-2');
      s1.className = 'flex items-center gap-4 transition-all duration-300';
      s2.className = 'flex items-center gap-4 transition-all duration-300';
      s1.querySelector('.step-icon').className = 'step-icon w-6 h-6 rounded bg-sky-500/20 text-sky-400 flex items-center justify-center text-[10px] font-bold animate-pulse';
      s1.querySelector('.step-message').innerText = 'Synthesizing...';
      s2.querySelector('.step-message').innerText = 'Waiting...';

      document.getElementById('generateBtn').disabled = true;
      document.getElementById('btnSpinner').classList.remove('hidden');
      document.getElementById('btnText').innerText = 'SYNTHESIZING...';

      // Simulate step 2 animation shortly after start
      setTimeout(() => {
        s1.classList.add('step-completed');
        s1.querySelector('.step-message').innerText = 'Logic synthesis successful';
        s2.querySelector('.step-icon').className = 'step-icon w-6 h-6 rounded bg-sky-500/20 text-sky-400 flex items-center justify-center text-[10px] font-bold animate-pulse';
        s2.querySelector('.step-message').innerText = 'Bundling assets...';
      }, 5000);

      google.script.run
        .withSuccessHandler(res => {
          document.getElementById('generateBtn').disabled = false;
          document.getElementById('btnSpinner').classList.add('hidden');
          document.getElementById('btnText').innerText = 'Synthesize Custom Demo Assets';

          if (!res.success) return onFailure(res.error);

          // Complete animation
          s2.classList.add('step-completed');
          s2.querySelector('.step-message').innerText = 'Bundle ready';

          setTimeout(() => {
            stepsSection.classList.add('hidden');
            currentData = res;
            showFinalResult(res);
            loadHistory();
          }, 800);
        })
        .withFailureHandler(onFailure)
        .generateDemo(userGoal, options);
    }

    function onFailure(err) {
      document.getElementById('generateBtn').disabled = false;
      document.getElementById('btnSpinner').classList.add('hidden');
      document.getElementById('stepsSection').classList.add('hidden');
      document.getElementById('errorSection').classList.remove('hidden');
      document.getElementById('errorMessage').innerText = err;
    }

    function showFinalResult(res) {
      document.getElementById('resultSection').classList.remove('hidden');
      document.getElementById('setupCommand').innerText = `cat <<'__SETUP_SH__' > setup.sh\n${res.setupScript}\n__SETUP_SH__\nbash setup.sh`;
      document.getElementById('systemInstruction').value = res.systemInstruction;

      // Guide
      const guideContainer = document.getElementById('demoGuideSteps');
      guideContainer.innerHTML = '';
      if (res.demoGuide && res.demoGuide.length) {
        res.demoGuide.forEach((step, i) => {
          // Extract prompt between quotes, single quotes, or Japanese corner brackets
          const match = step.match(/"([^"]+)"/) || step.match(/'([^']+)'/) || step.match(/„Äå([^„Äç]+)„Äç/);
          const prompt = match ? match[1] : step;
          const description = match ? step.replace(match[0], '').replace(/^[\d\s.]+|[:Ôºö]\s*/g, '').trim() : '';

          const div = document.createElement('div');
          div.className = "flex flex-col gap-3 p-5 rounded-2xl bg-black/40 border border-white/5 group hover:border-emerald-500/30 transition-all shadow-xl";
          div.innerHTML = `
               <div class="flex items-center gap-3">
                  <span class="text-[10px] font-bold text-emerald-400 bg-emerald-500/10 w-6 h-6 rounded-lg flex items-center justify-center shadow-inner">${i + 1}</span>
                  <p class="text-[11px] font-bold text-gray-400 uppercase tracking-tight">${description}</p>
               </div>
               <div class="relative bg-black/40 rounded-xl p-4 border border-white/5 group-hover:border-emerald-500/20 transition-all">
                  <p class="text-[13px] text-sky-200 select-all leading-relaxed font-mono">${prompt}</p>
                  <button onclick="copyText('${prompt.replace(/'/g, "\\'")}')" class="absolute top-2 right-2 p-2 rounded-lg bg-white/5 text-gray-500 hover:text-emerald-400 hover:bg-emerald-500/10 transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                  </button>
               </div>
            `;
          guideContainer.appendChild(div);
        });
      }

      // Preview
      const container = document.getElementById('dataPreview');
      container.innerHTML = '';
      res.dataPreview.forEach(table => {
        const div = document.createElement('div');
        div.className = 'glass rounded-xl overflow-hidden border border-white/5 shadow-2xl mb-6 bg-black/20';
        let html = `<div class="bg-white/5 px-4 py-2 flex items-center justify-between border-b border-white/5"><span class="text-[10px] font-bold text-sky-400 uppercase tracking-widest px-2 py-0.5 rounded bg-sky-500/10">${table.tableName}</span><span class="text-[9px] text-gray-500 font-mono">${table.rows.length} rows synthesized</span></div>`;
        html += `<div class="overflow-x-auto"><table class="w-full text-[10px] text-left"><thead class="bg-black/20 text-gray-500"><tr>`;
        table.headers.forEach(h => html += `<th class="px-4 py-3 font-semibold border-r border-white/5 last:border-0 uppercase tracking-tighter">${h}</th>`);
        html += `</tr></thead><tbody class="divide-y divide-white/5">`;
        table.rows.forEach(row => {
          html += `<tr class="hover:bg-white/5 transition-colors">`;
          table.headers.forEach(h => html += `<td class="px-4 py-2.5 text-gray-400 font-mono border-r border-white/5 last:border-0">${row[h]}</td>`);
          html += `</tr>`;
        });
        html += `</tbody></table></div>`;
        div.innerHTML = html;
        container.appendChild(div);
      });
      document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function updateScriptLocally() {
      const instr = document.getElementById('systemInstruction').value;
      google.script.run
        .withSuccessHandler(newScript => {
          currentData.setupScript = newScript;
          document.getElementById('setupCommand').innerText = `cat <<'__SETUP_SH__' > setup.sh\n${newScript}\n__SETUP_SH__\nbash setup.sh`;
        })
        .updateSystemInstruction(currentData.setupScript, instr);
    }

    function downloadFile(content, fileName, mimeType) {
      const blob = new Blob([content], { type: mimeType });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = fileName; a.click();
      window.URL.revokeObjectURL(url);
    }
    function downloadScript() { if (currentData) downloadFile(currentData.setupScript, 'setup.sh', 'text/x-shellscript'); }
    function downloadAllCSV() { if (currentData && currentData.rawTables) currentData.rawTables.forEach(t => downloadFile(t.csvData, `${t.tableName}.csv`, 'text/csv')); }

    function showToast(message = 'Copied to clipboard!') {
      const toast = document.getElementById('toast');
      toast.innerText = message;
      toast.className = 'show';
      setTimeout(() => { toast.className = toast.className.replace('show', ''); }, 3000);
    }

    function copyText(text) {
      navigator.clipboard.writeText(text);
      showToast();
    }

    function copy(id) {
      const el = document.getElementById(id);
      navigator.clipboard.writeText(el.innerText || el.value);
      showToast();
    }

    function loadHistory() {
      google.script.run.withSuccessHandler(history => {
        const list = document.getElementById('historyList');
        if (!list) return;
        list.innerHTML = '';
        if (history && history.length) {
          history.forEach(item => {
            const div = document.createElement('div');
            div.dataset.timestamp = item.timestamp;
            div.onclick = () => loadDemoFromHistory(item.timestamp);
            div.className = 'glass p-3 rounded-xl border border-white/5 hover:border-sky-500/50 cursor-pointer transition-all group shadow-sm bg-black/20 flex items-start gap-2 relative';
            div.innerHTML = `
                <div class="flex-1 min-w-0">
                  <div class="text-[9px] text-gray-600 mb-1 font-mono">${new Date(item.timestamp).toLocaleDateString()} ${new Date(item.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                  <div class="text-[10px] text-gray-400 line-clamp-2 group-hover:text-white tracking-tight leading-snug">${item.userGoal}</div>
                </div>
                <button onclick="deleteHistoryItemFromUI('${item.timestamp}', event)" class="opacity-0 group-hover:opacity-100 p-1.5 rounded-lg hover:bg-red-500/20 text-gray-500 hover:text-red-400 transition-all">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                </button>
            `;
            list.appendChild(div);
          });
        }
      }).getHistory();
    }

    function loadDemoFromHistory(timestamp) {
      if (document.getElementById('generateBtn').disabled) return;

      const listItems = document.querySelectorAll('#historyList > div');
      listItems.forEach(el => el.classList.remove('border-sky-500/80', 'bg-sky-500/5'));

      google.script.run.withSuccessHandler(entry => {
        if (!entry || !entry.result) return alert('Failed to load history data.');

        // Populate form
        document.getElementById('userGoal').value = entry.userGoal;
        if (entry.options) {
          if (entry.options.rowCount) document.getElementById('rowCount').value = entry.options.rowCount;
          if (entry.options.tableCount) document.getElementById('tableCount').value = entry.options.tableCount;
          if (entry.options.publicDatasetId) document.getElementById('publicDatasetId').value = entry.options.publicDatasetId;
        }

        // Populate results
        currentData = entry.result;
        showFinalResult(entry.result);

        // Highlight selected
        const target = document.querySelector(`#historyList > div[data-timestamp="${timestamp}"]`);
        if (target) target.classList.add('border-sky-500/80', 'bg-sky-500/5');

      }).getHistoryItem(timestamp);
    }

    function deleteHistoryItemFromUI(timestamp, event) {
      event.stopPropagation();
      if (!confirm('Remove this demo from history?')) return;

      google.script.run.withSuccessHandler(() => {
        loadHistory();
        // If current data matches deleted item, clear UI? Optional.
      }).deleteHistoryItem(timestamp);
    }

    function clearHistory() { if (confirm('Clear ALL history?')) google.script.run.withSuccessHandler(loadHistory).clearHistory(); }

    window.onload = () => {
      loadHistory();
      updateSamples();

      // Scroll Spy Implementation
      const sections = document.querySelectorAll('section[id], div[id^="section-"]');
      const navItems = document.querySelectorAll('.nav-item');

      const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.3
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            navItems.forEach(item => {
              item.classList.remove('active');
              if (item.getAttribute('data-section') === entry.target.id) {
                item.classList.add('active');
              }
            });
          }
        });
      }, observerOptions);

      sections.forEach(section => observer.observe(section));
    };
  </script>
</body>

</html>